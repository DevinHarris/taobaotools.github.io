function convert(){for(var a=document.getElementById("content").value.split("\n"),b=[],c=[],d=0;d<a.length;d++){var e=a[d];isTaobaoURL(e)?b.push(cleanURL(convertURL(e))):c.push(a[d])}var f;f=1==c.length&&""==c[0]?0:c.length,setHTML("message",getStatus(a.length,b.length,f)),b.length>0&&setComponents(!0,b),c.length>0&&""!=c[0]&&setComponents(!1,c)}function setComponents(a,b){var c=a?"valid":"invalid";setDisplay("content",!1),setDisplay(c,!0),setDisplay(c+"-copy",!0),setHTML(c+"-copy","Copy to clipboard");for(var d="<h3>"+(a?"Valid":"Invalid")+"</h3>",e=0;e<b.length;e++)d+="<a href='"+b[e]+"' target='_blank'>"+b[e]+"</a>";setHTML(c,d),setHTML(c+"-hidden",b.join("<br>")),document.getElementById("actions").style.paddingTop="15px"}function isTaobaoURL(a){var b=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return b.test(a)&&a.indexOf("taobao.com")!=-1}function convertURL(a){if(a.indexOf("m.intl.taobao.com")!=-1)return a.replace("m.intl","item").replace("detail/detail","item").replace("detail/desc","item");if(a.indexOf("h5.m.taobao.com")!=-1){for(var b=a.indexOf("?id=")+4,c=a.length,d=b;d<a.length;d++)if(!isDigit(a.charAt(d))){c=d;break}var e=a.substring(b,c);return"https://item.taobao.com/item.htm?id="+e}if(a.indexOf("m.taobao.com")!=-1){if(a.indexOf("shop.m.taobao.com")!=-1){for(var b=a.indexOf("shop_id=")+8,c=a.length,d=b;d<a.length;d++)if(!isDigit(a.charAt(d))){c=d;break}var f=a.substring(b,c);return"https://shop"+f+".taobao.com"}if(a.indexOf("item")==-1)return a.replace("m.taobao","taobao");for(var b=a.indexOf("id=")+3,c=a.length,d=b;d<a.length;d++)if(!isDigit(a.charAt(d))){c=d;break}var g=a.substring(b,c);return"https://item.taobao.com/item.htm?id="+g}if(a.indexOf("world.taobao.com")!=-1){if(a.indexOf("item")!=-1){var b=a.indexOf("item/")+5,c=a.indexOf(".htm"),h=a.substring(b,c);return"https://item.taobao.com/item.htm?id="+h}return a.replace("world.taobao","taobao")}for(var b=a.indexOf("id=")+3,c=a.length,d=b;d<a.length;d++)if(!isDigit(a.charAt(d))){c=d;break}var g=a.substring(b,c);return"https://item.taobao.com/item.htm?id="+g}function cleanURL(a){for(var b="",c=!1,d=0;d<a.length;d++)"?"==a.charAt(d)&&c?b+="&":"?"==a.charAt(d)?(b+="?",c=!0):b+=a.charAt(d);return b}function setHTML(a,b){document.getElementById(a).innerHTML=b}function setDisplay(a,b){document.getElementById(a).style.display=b?"unset":"none"}function getStatus(a,b,c){return c==a?"All the links are invalid.":"Converted "+b+linkOrLinks(b)+" Found "+c+" invalid"+linkOrLinks(c)}function linkOrLinks(a){return 1==a?" link.":" links."}function reset(){document.getElementById("content").value="",setDisplay("content",!0),setHTML("message",""),setDisplay("valid",!1),setDisplay("valid-copy",!1),setDisplay("invalid-copy",!1),setDisplay("invalid",!1)}function isDigit(a){return"0"==a||"1"==a||"2"==a||"3"==a||"4"==a||"5"==a||"6"==a||"7"==a||"8"==a||"9"==a}